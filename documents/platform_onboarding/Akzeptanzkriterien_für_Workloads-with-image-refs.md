## Akzeptanzkriterien für Workloads

Die Vorgaben erfolgen hierbei durch das Plattformteam, während die Applikationsteams diese befolgen bzw. innerhalb ihrer Container (Images) einhalten.

## Hinweise zu Begriffen:

- · MAGIC steht für Moderne agile Container-Plattform und ist die interne ContainerPlattform, um containerbasierte Applikationen zu entwickeln, bauen und betreiben. Technisch setzt MAGIC auf Red Hat OpenShift Container Plattform auf. In der Regel die aktuelle Version minus 1-2 Versionsständen.
- · MAGIC-Team ist das Plattform-Team, welches das Produkt MAGIC verantwortet.
- · ISV (Independent Software Vendor) ist ein externer Lieferant für container-basierte Applikationen, die auf MAGIC betrieben werden
- · Applikations-Teams sind interne Teams, die containerbasierte Applikationen auf MAGIC u.a. betreiben. Betrieb bedeutet hier, dass diese Teams das Deployment der Applikation auf MAGIC und damit auch die notwendigen HELM-Charts oder vergleichbar verantworten.

## Verwendung der Modalverben Muss und Soll

Dieses Dokument verwendet an dieser Stelle folgende Begriffsdefinitionen:

| Ausdruck   | Bedeutung                                                         |
|------------|-------------------------------------------------------------------|
| MUSS       | So gekennzeichnete Anforderungen müssen unbedingt erfüllt werden. |

| Ausdruck   | Bedeutung                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SOLL       | Dieser Ausdruck bedeutet, dass eine Anforderung zwar normalerweise erfüllt werden muss, bei stichhaltigen Gründen aber auch davon abgesehen werden kann und dies ggf. auch Genehmigungspflichtig ist (wird bei Kriterium vermerkt). Wenn von diesem Kriterium abgewichen werden kann, bedeutet dass, das MAGIC-Team beim Betrieb der Plattform davon ausgeht, dass dieses Kriterium erfüllt wird und Einschränkungen die aus Nichterfüllung resultieren vom Applikations-Team akzeptiert werden. |

## Hinweis für eine Nutzung als Leistungsverzeichnis (LV):

- · Die Kriterien sind in der Formulierung nicht konsistent geeignet, um diese als Ausschlusskriterium im Sinne einer geschlossenen Frage als JA/NEIN zu beantworten. Eine weitere Schärfung für ein LV In der Formulierung ist erforderlich.

Info bei Update der Akzeptanzkriterien

Beim Update der Akzeptanzkriterien ist auch ein neues Word für die Externe Version zu erstellen.

## Technische Richtlinien

- Containerbasierte Software / Applikationen -

April 2021 / Aktualisiert Dezember 2023

## Allgemeine Richtlinie

MAGIC unterstützt durch die verwendete Architektur containerbasierte Applikationen, die cloud-nativen Architekturstandards entsprechen. Bitte kontaktieren Sie den MAGIC Produktverantwortlichen (Product Owner - PO) für weitergehende Informationen. Cloud-native- und Micro Service-Architekturen erfordern Applikationen mit eingebauter Redundanz und Verfügbarkeit. Außerdem sollen Applikationen so gestaltet sein, dass sie horizontal skalieren (Scale-out), um die maximale Größe pro Container-Image zu verringern.

## Sektion A: Technische Anforderungen und Empfehlungen

| Nr.                   | Kategorie              | Priorität             | Kriterien             | Beschreibung                                                                                                                                                                                                                                                                                                                                                                                                                                | Verantwortlich                |
|-----------------------|------------------------|-----------------------|-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
| Image Spezifikationen | Image Spezifikationen  | Image Spezifikationen | Image Spezifikationen | Image Spezifikationen                                                                                                                                                                                                                                                                                                                                                                                                                       | Image Spezifikationen         |
| 1                     | Image- Spezifikationen | Muss                  | OCI Kompatibilität    | Wenn alle Komponenten der containerisierten Applikation vom Applikationsteam oder einem externen Softwareanbieter (ISV) als Container-Images zur Verfügung gestellt werden, ist die Kompatibilität zu den Image- und Laufzeitspezifikationen der Open Container Initiative (OCI) sicherzustellen. Ein Image-Manifest (Dockerfile) muss für jedes Container Image mitgeliefert werden. Siehe hierzu auch: https://github.com/opencontainers/ | Applikationsteam Externer ISV |
| 2                     | Image- Spezifikationen | Muss                  | Image Unterstützung   | Alle Images, die von Applikationsteams oder externen ISV erstellt bzw. bereitgestellt werden, müssen auf zertifizierten, sicheren und validierten Basis-Images basieren.                                                                                                                                                                                                                                                                    | Applikationsteam Externer ISV |
| 3                     | Image- Spezifikationen | Muss                  | Minimale Images       | Container sind lediglich mit der Software ausgestattet, die benötigt wird, um den zugrunde liegenden Microservice zu betreiben. Sämtliche darüber hinaus nicht benötigte Softwarepakete oder Bibliotheken sind im Image Erstellungsprozess entfernt worden, sodass daraus abgebildete Container als gehärtet betrachtet werden können. Standardbenutzer der verwendeten Software in Containern sind entfernt oder deaktiviert.              | Applikationsteam Externer ISV |

| 4                              | Image- Spezifikationen         | Muss                           | Keine Root- Berechtigungen      | Kein Prozess innerhalb des Containers braucht Root- Berechtigungen. Container mit privilegierten Rechten sind nicht erlaubt. Applikationen sollten in Verzeichnissen mit ausreichenden Rechten gespeichert (z.B. "/apps") werden. Ports unterhalb von 1024 dürfen nicht genutzt werden.                                                                                                                                                                     | Applikationsteam Externer ISV   |
|--------------------------------|--------------------------------|--------------------------------|---------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
| 5                              | Image- Spezifikationen         | Muss                           | Benutzer-ID                     | MAGIC teilt automatisiert eine nicht privilegierte Benutzer-ID zu, unter der die Prozesse des Containers laufen. Der vom Applikationsteam oder externem ISV ausgelieferte Container sollte diese ID bestimmen und nutzen können - ohne eine fixe ID verwenden zu müssen.                                                                                                                                                                                    | Applikationsteam Externer ISV   |
| 6                              | Image- Spezifikationen         | Soll                           | Variablen                       | Alle nicht-sensiblen Parameter von Prozeduren oder Container-Images sollten extern spezifiziert werden und nicht im OCI Image enthalten sein, sondern beim Starten an den Container gehangen werden.                                                                                                                                                                                                                                                        | Applikationsteam Externer ISV   |
| 7                              | Image- Spezifikationen         | Muss                           | Variablen                       | Alle sensiblen Parameter (z.B. Private Keys oder Passwörter) der Prozedur oder Container Images müssen extern in einem "Key Management System" (siehe auch Punkt 14) spezifiziert werden. Es ist nicht erlaubt, diese im OCI Image zu speichern. Sie müssen beim Start des Containers herangezogen (z.B. Mount) werden. Technisch muss hierbei sichergestellt sein, dass selbst entwickelte oder eingekaufte Software mit Kubernetes Secrets arbeiten kann. | Applikationsteam Externer ISV   |
| Kubernetes (abgekürzt als K8s) | Kubernetes (abgekürzt als K8s) | Kubernetes (abgekürzt als K8s) | Kubernetes (abgekürzt als K8s)  | Kubernetes (abgekürzt als K8s)                                                                                                                                                                                                                                                                                                                                                                                                                              | Kubernetes (abgekürzt als K8s)  |
| 9                              | K8s                            | Muss                           | K8S clusterweite Berechtigungen | Die Applikation wird auf einem oder mehreren Kubernetes Namespaces isoliert ausgebracht. Das Applikationsteam bekommt nur (Project- )Administrationsrechte für die zugeteilten Namespaces. Sie erhalten keine clusterweiten Zugänge.                                                                                                                                                                                                                        | Applikationsteam Externer ISV   |

| 11         | K8s        | Muss       | Kubernetes Liveness & Readiness Probe   | Jedes Container-Image der Applikation stellt eine Liveness-Probe (Applikationsprozess ist verfügbar) und eine Readiness-Probe (Applikationslogik funktioniert korrekt, Komponenten sind korrekt verbunden und externe Dienste sowie Datenbanken sind verfügbar) zur Verfügung. Die Probes sind im Kubernetes-Manifest konfiguriert. Siehe auch: https://kubernetes.io/docs/tasks/configure- pod-container/configure-liveness-readiness-startup- probes/   | Applikationsteam Externer ISV   |
|------------|------------|------------|-----------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
| 12         | K8s        | Muss       | Verfügbarkeit der Applikation (HA)      | Die Applikation ist so gestaltet, dass der Ausfall oder Neustart eines Pods toleriert wird. Für eine Bereitstellung mit Hochverfügbarkeit sind mindestens zwei laufende Pods notwendig, die auf demselben Container-Image basieren. Beide Pods müssen in zwei getrennten Verfügbarkeitszonen / Rechenzentren gestartet werden (siehe Punkt 26). Zur Ausgestaltung siehe z.B. How-To Hochverfügbare Microservices.                                         | Applikationsteam Externer ISV   |
| Persistenz | Persistenz | Persistenz | Persistenz                              | Persistenz                                                                                                                                                                                                                                                                                                                                                                                                                                                | Persistenz                      |
| 13         | Persistenz | Soll       | Externe Persistenz                      | Daten werden, soweit notwendig, in persistenten Volumes gespeichert. Im Container sollen keine Daten gespeichert werden, da diese nach Beendigung des Containers verloren gehen. Davon ausgenommen sind temporäre Daten, deren Verlust keinen Effekt auf die Applikationsfunktionalität hat. Siehe Punkt 16 zur Ablage von Logdaten.                                                                                                                      | Applikationsteam Externer ISV   |
| Sicherheit | Sicherheit | Sicherheit | Sicherheit                              | Sicherheit                                                                                                                                                                                                                                                                                                                                                                                                                                                | Sicherheit                      |

| 14a                                                                   | Sicherheit                                                            | Soll                                                                  | Kommunikation                                                         | Applikationen sind hinsichtlich ihrer Netzwerkverbindung so konfiguriert, dass sie mittels TLS ausschließlich verschlüsselt und zertifikatsbasierend miteinander kommunizieren.                                                                                                                                                        | Applikationsteam Externer ISV                                         |
|-----------------------------------------------------------------------|-----------------------------------------------------------------------|-----------------------------------------------------------------------|-----------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------|
| 14b                                                                   | Sicherheit                                                            | Muss                                                                  | Kommunikation                                                         | Applikationen sind so konfiguriert, dass sie ausschließlich authentisiert miteinander kommunizieren.                                                                                                                                                                                                                                   |                                                                       |
| Überwachung &Deployment                                               | Überwachung &Deployment                                               | Überwachung &Deployment                                               | Überwachung &Deployment                                               | Überwachung &Deployment                                                                                                                                                                                                                                                                                                                | Überwachung &Deployment                                               |
| 15                                                                    | Überwachung &Deployment                                               | Muss                                                                  | Deployment mit K8s Operator oder Helm Chart                           | Die Applikation muss Helm Charts oder einen Kubernetes Operator für das Deployment verwenden. Wird ein Operator verwendet muss dieser über ein Helm Chart ausgerollt werden. Für die Nutzung in Systemumgebungen außerhalb der Entwicklung (dev) müssen Helm Charts paketiert und in der Registry der MAGIC-Plattform abgelegt werden. | Applikationsteam Externer ISV                                         |
| 15a                                                                   | Überwachung &Deployment                                               | Muss                                                                  | Deployment mit K8s Operator oder Helm Chart                           | Seitens des Applikationsteams bzw. ISV wird ein für MAGIC (OpenShift) getestetes und funktionales Deployment bereitgestellt.                                                                                                                                                                                                           | Applikationsteam Externer ISV                                         |
| 16                                                                    | Überwachung &Deployment                                               | Muss                                                                  | Logging                                                               | Betriebliche Logdaten, die an STDOUT/STDERR gesendet werden, werden durch MAGIC erfasst und für eine begrenzte Frist vorgehalten. Diese Logdaten sollten nicht in eigene persistente Volumes gespeichert werden (siehe Punkt 13).                                                                                                      | Applikationsteam Externer ISV                                         |
| 17                                                                    | Überwachung &Deployment                                               | Soll                                                                  | Logging                                                               | Die Applikation soll Logs in einem maschinenlesbaren Textformat ausgeben.                                                                                                                                                                                                                                                              | Applikationsteam Externer ISV                                         |
| Sektion B: Organisatorische &betriebliche Anforderungen &Empfehlungen | Sektion B: Organisatorische &betriebliche Anforderungen &Empfehlungen | Sektion B: Organisatorische &betriebliche Anforderungen &Empfehlungen | Sektion B: Organisatorische &betriebliche Anforderungen &Empfehlungen | Sektion B: Organisatorische &betriebliche Anforderungen &Empfehlungen                                                                                                                                                                                                                                                                  | Sektion B: Organisatorische &betriebliche Anforderungen &Empfehlungen |
| Nr.                                                                   | Kategorie                                                             | Priorität                                                             | Kriterien                                                             | Beschreibung                                                                                                                                                                                                                                                                                                                           | Verantwortlich                                                        |

## Überwachung &amp; Deployment

## Image-Spezifikationen

|   21 | Image- Spezifikationen   | Muss   | Aktualisierung SLA   | Wenn eine neue Version eines Basis- oder Build-Images verfügbar wird, die ein hohes Sicherheitsrisiko behebt, muss ein neues Container-Image basierend auf diesen Images innerhalb der vertraglich definierten Zeiten bzw. gemäß den RZF-Vorgaben bereitgestellt werden. Die Verantwortung liegt beim Eigentümer des Image- Manifests (Dockerfiles). Dieses Image muss im Anschluss zeitnah ausgerollt werden.            | Applikationsteam Externer ISV MAGIC Team   |
|------|--------------------------|--------|----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|   22 | Image- Spezifikationen   | Muss   | Unveränderlichkeit   | Container-Images werden spätestens ab Systemumgebung QSI unveränderlich (immutable) weitergeleitet. Veränderungen an dem Container-Images sind ab diesem Punkt nicht mehr erlaubt. Bei der Referenzierung von Containerimages (z.B. in Deploymentbeschreibungen) ist spätestens ab Systemumgebung QSI auf SHA-Digests, mindestens aber eindeutige Versionsnummern zu verweisen, anstelle von laufenden Tags wie "latest". | Applikationsteam Externer ISV MAGIC Team   |
|   23 | Image- Spezifikationen   | Muss   | Lizensierung         | Externe ISV und interne Applikationsteams stellen sicher, dass alle Softwarekomponenten in zur Verfügung gestellten Container-Images ausreichend lizensiert sind.                                                                                                                                                                                                                                                         | Applikationsteam Externer ISV              |

| 24                             | Image- Spezifikationen         | Muss                           | Automatische Aktualisierung    | Kontinuierliche Updates der Container-Images werden durch einen automatisierten Prozess mit einem sicheren Endpunkt, der durch den externen ISV oder dem Applikationsteam bereitgestellt wird, realisiert. Die Images müssen in einer Container Registry abgelegt sein, ein FTP Server als Quelle ist z.B. nicht valide.                                                                                                                                                       | Applikationsteam Externer ISV   |
|--------------------------------|--------------------------------|--------------------------------|--------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
| Kubernetes (abgekürzt als K8S) | Kubernetes (abgekürzt als K8S) | Kubernetes (abgekürzt als K8S) | Kubernetes (abgekürzt als K8S) | Kubernetes (abgekürzt als K8S)                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Kubernetes (abgekürzt als K8S)  |
| 27                             | K8s                            | Muss                           | HA/DR                          | Seitens der Applikationsteams bzw. des externen ISV wird sichergestellt, dass ein hochverfügbares Deployment der Applikation in mindestens zwei Verfügbarkeitszonen erfolgt (siehe auch Punkt 12). Beispiel: PodTopologySpreadConstraints. Zur Ausgestaltung siehe z.B. How-To Hochverfügbare Microservices.                                                                                                                                                                   | Applikationsteam Externer ISV   |
| 29                             | K8s                            | Muss                           | Begrenzungen und Quotas        | Applikationsteams und / oder externe ISV müssen eine maschinenlesbare Übersicht der Container-Images und ihrer Ressourcen (CPU, Memory, Speicherkapazität, und IOPS bei Bedarf) bereitstellen, aus der die notwendigen Gesamt-Ressourcen / Quotas pro Kubernetes Namespace hergeleitet werden können. Die entsprechenden Requests (CPU und Memory) und Limits (Memory) müssen im Deployment, dem StatefulSet oder dem jeweils verwendeten Kubernetes Objekt hinterlegt werden. | Applikationsteam Externer ISV   |
| 30                             | K8s                            | Muss                           | Deployment mit Helm 3          | Bei Verwendung von Helm muss mindestens Helm 3 verwendet werden (Details zum Hintergrund).                                                                                                                                                                                                                                                                                                                                                                                     | Applikationsteam Externer ISV   |

| 32         | K8s        | Soll       | Multikomponenten Anwendung   | Wenn die Applikation aus mehreren Komponenten besteht und/oder mehrere externe Dienste benutzt, müssen diese in passender Form beschrieben werden. Das kann z.B. ein Architekturbild sein, das alle notwendigen Komponenten (Microservices und ihre Abhängigkeiten) enthält.                                                                                                                                                                                                                                                                                                   | Applikationsteam Externer ISV   |
|------------|------------|------------|------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
| Persistenz | Persistenz | Persistenz | Persistenz                   | Persistenz                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Persistenz                      |
| 33         | Persistenz | Muss       | PVC/PV dynamisch             | Persistenter Speicher wird dynamisch über Kubernetes Persistent Volumes (PV) bereitgestellt. Die Nutzung von statischem Storage (wie beispielsweise hostpath) wird nicht unterstützt. Das Applikationsteam und / oder externe ISV stellt Persistent Volume Claims (PVCs) für dynamischen persistenten Speicher bereit. MAGIC arbeitet hier mit Storage Optionen die CSI (Container Storage Interface) kompatibel sind. Die Daten im persistenten Speicher steht im Allgemeinen nicht nach einer Cluster-Neuinstallation zur Verfügung (bspw. im Rahmen von Desaster Recovery). | Applikationsteam Externer ISV   |

## Sicherheit

| 35   | Sicherheit   | Muss   | Imageakzeptanz                             | Container-Images werden mit einem Prüfwerkzeug, das Teil der MAGIC Plattform ist, überprüft (Schwachstellen-Prüfung). Bei kritischen Sicherheitslücken wird das Container-Image nicht akzeptiert und das Applikationsteam / der externe ISV müssen ein sicheres Image innerhalb der definierten Dienstleistungsvereinbarung bereitstellen. Die Mitigation von Sicherheitsrisiken (z.B. das Patchen) ist die Verantwortlichkeit der Eigentümer des Image-Manifests (Dockerfile).                | Applikationsteam Externer ISV            |
|------|--------------|--------|--------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
| 36   | Sicherheit   | Muss   | Lösung von später erkannten Schwachstellen | Container-Images werden regelmäßig auf Basis der aktuellen CVE Datenquelle überprüft. Das Auftreten einer kritischen Sicherheitslücke nach ursprünglicher Akzeptanz (im Falle neuer CVE Einträge) ist möglich. Die Verantwortung für die Behebung innerhalb der definierten Servicevereinbarung (SLA) obliegt dem Team, welches sich für das Image-Manifest (Dockerfile) verantwortlich zeichnet. In der Regel ist dies das Applikationsteam oder der ISV.                                     | Applikationsteam Externer ISV            |
| 39   | Sicherheit   | Soll   | Remote- Containerzugriff                   | Container dürfen keine Dienste für einen administrativen Fernzugriff (Beispiel SSH Daemon) ausführen.                                                                                                                                                                                                                                                                                                                                                                                          | Applikationsteam Externer ISV            |
| 39a  | Sicherheit   | Muss   | Mikro- Segmentation von Containern         | Sämtliche additive Regeln zum Einschränken der Kommunikationsverbindung eigener Container müssen von den Applikationsteams angelegt (bzw. von einem externen ISV bereitgestellt) und verwaltet werden. Das Applikationsteam stellt über geeignete NetworkPolicies sicher, dass nur notwendige Kommunikationsbeziehungen möglich sind (Mikro- Segmentierung). Gemäß den Sicherheitsvorgaben sind auch die Kommunikation im Namespace minimal freizuschalten, was dem Applikationsteams obliegt. | Applikationsteam Externer ISV MAGIC Team |

| 40                               | Sicherheit                       | Muss                             | Berechtigungen für Service-Accounts   | Berechtigungen für Service-Accounts müssen auf die unbedingt notwendigen Rechte (minimale Berechtigungen) beschränkt werden. Pods, die keinen Service-Account benötigen, sollten diesen nicht einsehen können und keinen Zugriff auf entsprechende Token haben. Hinweis: Dieser Punkt bezieht sich ausschließlich MAGIC-Cluster interne Service-Accounts. Service- Accounts von angrenzenden Systemen müssen mit den entsprechenden Verantwortlichen abgestimmt werden.   | Applikationsteam Externer ISV MAGIC Team   |
|----------------------------------|----------------------------------|----------------------------------|---------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
| Allgemeines zum Containerbetrieb | Allgemeines zum Containerbetrieb | Allgemeines zum Containerbetrieb | Allgemeines zum Containerbetrieb      | Allgemeines zum Containerbetrieb                                                                                                                                                                                                                                                                                                                                                                                                                                          | Allgemeines zum Containerbetrieb           |
| 43                               | Allgemein                        | Soll                             | Pod Neustarts                         | Alle Pods werden in regelmäßigen Abständen automatisch neu gestartet. Keiner dieser Pods läuft hierbei länger als 24 Stunden. Durch ein geeignetes Deployment ist die Verfügbarkeit der Anwendung sicherzustellen. Hinweis: Ein Neustart der Pods wird von MAGIC erzwungen. Die Nichteinhaltung dieses Kriteriums bedeutet, dass Einschränkungen wie z.B. kurze Ausfälle des Workloads während Pod-Neustarts hingenommen werden.                                          | Applikationsteams MAGIC-Team               |
